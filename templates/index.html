<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake News Detection System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .fake-gradient {
            background: linear-gradient(135deg, #f56565 0%, #ed64a6 100%);
        }
        .true-gradient {
            background: linear-gradient(135deg, #48bb78 0%, #38b2ac 100%);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        .glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-newspaper text-2xl"></i>
                    <h1 class="text-2xl font-bold">Fake News Detector AI</h1>
                </div>
                <div class="flex space-x-4">
                    <a href="/" class="hover:text-gray-200 font-medium px-3 py-2 rounded bg-white/10">Home</a>
                    <a href="/demo" class="hover:text-gray-200 font-medium px-3 py-2 rounded bg-white/10">Demo</a>
                    <a href="/health" target="_blank" class="hover:text-gray-200 font-medium px-3 py-2 rounded bg-white/10">API Status</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-12">
            <div class="inline-block p-4 bg-white rounded-full shadow-lg mb-6">
                <i class="fas fa-robot text-4xl gradient-bg bg-clip-text text-transparent"></i>
            </div>
            <h2 class="text-4xl font-bold text-gray-800 mb-4">
                AI-Powered Fake News Detection
            </h2>
            <p class="text-gray-600 text-lg max-w-2xl mx-auto">
                Detect fake news with high accuracy using machine learning. Our AI analyzes linguistic patterns, sensationalism, and reliability indicators.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <!-- Input Section -->
            <div class="bg-white rounded-xl shadow-lg p-6 glow">
                <div class="flex items-center mb-6">
                    <div class="p-3 gradient-bg rounded-lg mr-4">
                        <i class="fas fa-edit text-white text-xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800">Analyze News Text</h3>
                </div>
                
                <div class="mb-6">
                    <label class="block text-gray-700 font-medium mb-3">
                        <i class="fas fa-newspaper mr-2"></i>Enter News Article:
                    </label>
                    <textarea 
                        id="newsText" 
                        class="w-full h-64 p-4 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                        placeholder="Paste news article text here... 

Examples:
• 'BREAKING: Secret cure revealed!'
• 'Scientists discovered new species...'
• 'URGENT: Government conspiracy exposed!'"></textarea>
                    <div class="flex justify-between text-sm text-gray-500 mt-2">
                        <span id="charCount">0 characters</span>
                        <span>50+ characters recommended</span>
                    </div>
                </div>
                
                <button 
                    onclick="analyzeNews()"
                    id="analyzeBtn"
                    class="w-full gradient-bg hover:opacity-90 text-white font-bold py-4 px-4 rounded-lg transition duration-300 flex items-center justify-center text-lg">
                    <i class="fas fa-search mr-3"></i> Analyze for Fake News
                </button>
                
                <!-- Loading Indicator -->
                <div id="loading" class="hidden mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <div class="flex items-center">
                        <div class="pulse">
                            <i class="fas fa-spinner fa-spin text-blue-600 text-xl mr-3"></i>
                        </div>
                        <div>
                            <p class="font-medium text-blue-800">AI Analysis in Progress</p>
                            <p class="text-sm text-blue-600">Analyzing linguistic patterns and indicators...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center mb-6">
                    <div class="p-3 bg-green-100 rounded-lg mr-4">
                        <i class="fas fa-chart-bar text-green-600 text-xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800">Analysis Results</h3>
                </div>
                
                <div id="resultContainer" class="hidden">
                    <!-- Result Card -->
                    <div id="resultCard" class="mb-6 p-6 rounded-lg border-2 transition-all duration-500">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h4 id="resultTitle" class="text-xl font-bold">Analysis Result</h4>
                                <p id="resultSubtitle" class="text-gray-600">AI-powered assessment</p>
                            </div>
                            <span id="resultBadge" class="px-4 py-2 rounded-full text-lg font-bold"></span>
                        </div>
                        
                        <!-- Confidence Meter -->
                        <div class="mb-8">
                            <div class="flex justify-between mb-2">
                                <span class="text-gray-700 font-medium">Confidence Level</span>
                                <span id="confidenceText" class="font-bold text-lg">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div id="confidenceBar" class="h-4 rounded-full transition-all duration-1000"></div>
                            </div>
                        </div>
                        
                        <!-- Probability Cards -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="text-center p-4 bg-green-50 rounded-lg border border-green-200">
                                <p class="text-sm text-gray-600 mb-1">True News Probability</p>
                                <p id="trueProbability" class="text-3xl font-bold text-green-600">0%</p>
                            </div>
                            <div class="text-center p-4 bg-red-50 rounded-lg border border-red-200">
                                <p class="text-sm text-gray-600 mb-1">Fake News Probability</p>
                                <p id="fakeProbability" class="text-3xl font-bold text-red-600">0%</p>
                            </div>
                        </div>
                        
                        <!-- Key Indicators -->
                        <div id="indicatorsContainer" class="mb-6 hidden">
                            <h5 class="font-bold text-gray-700 mb-3 flex items-center">
                                <i class="fas fa-exclamation-triangle mr-2"></i> Key Indicators Found
                            </h5>
                            <div id="indicatorsList" class="space-y-2"></div>
                        </div>
                        
                        <!-- Details -->
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <h5 class="font-bold text-gray-700 mb-2 flex items-center">
                                <i class="fas fa-info-circle mr-2"></i> Analysis Details
                            </h5>
                            <p class="text-gray-600 text-sm" id="analysisDetails">
                                The AI analyzed linguistic patterns, word choices, and structural features.
                            </p>
                            <div class="mt-3 text-xs text-gray-500">
                                <p><i class="fas fa-microchip mr-1"></i> Model: Ensemble (XGBoost, Random Forest, Logistic Regression)</p>
                                <p><i class="fas fa-database mr-1"></i> Features: TF-IDF + Enhanced Linguistic Analysis</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Try Another Button -->
                    <button 
                        onclick="resetForm()"
                        class="w-full border-2 border-blue-600 text-blue-600 hover:bg-blue-50 font-bold py-3 px-4 rounded-lg transition duration-300">
                        <i class="fas fa-redo mr-2"></i> Analyze Another Text
                    </button>
                </div>
                
                <!-- Empty State -->
                <div id="emptyState" class="text-center py-12">
                    <div class="inline-block p-6 bg-gray-100 rounded-full mb-6">
                        <i class="fas fa-chart-line text-4xl text-gray-400"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-700 mb-2">Ready for Analysis</h4>
                    <p class="text-gray-500">Enter news text and click "Analyze" to see AI-powered results</p>
                </div>
            </div>
        </div>

        <!-- Info Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-md transition">
                <div class="text-blue-600 text-2xl mb-4">
                    <i class="fas fa-brain"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">Advanced AI Models</h4>
                <p class="text-gray-600">Uses ensemble of machine learning models trained on linguistic patterns and sensationalism indicators.</p>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-md transition">
                <div class="text-green-600 text-2xl mb-4">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">High Confidence Detection</h4>
                <p class="text-gray-600">Identifies clear fake news with >80% confidence using multiple verification methods.</p>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow hover:shadow-md transition">
                <div class="text-purple-600 text-2xl mb-4">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <h4 class="font-bold text-lg mb-2">Real-time Analysis</h4>
                <p class="text-gray-600">Instantly analyzes text for 15+ indicators including sensationalism, reliability, and exaggeration.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <h3 class="text-xl font-bold mb-4">Fake News Detection AI System</h3>
                <p class="text-gray-200 mb-6">Machine Learning Project | Built with Flask, XGBoost & Python</p>
                <div class="flex justify-center space-x-6">
                    <span class="px-3 py-1 bg-white/20 rounded">TensorFlow</span>
                    <span class="px-3 py-1 bg-white/20 rounded">scikit-learn</span>
                    <span class="px-3 py-1 bg-white/20 rounded">XGBoost</span>
                    <span class="px-3 py-1 bg-white/20 rounded">Flask</span>
                </div>
                <p class="mt-6 text-sm text-gray-300">Note: This system demonstrates AI capabilities. For critical decisions, verify with multiple sources.</p>
            </div>
        </div>
    </footer>

    <script>
        // Character counter
        document.getElementById('newsText').addEventListener('input', function() {
            const count = this.value.length;
            document.getElementById('charCount').textContent = count + ' characters';
        });
        
        // Analyze single news article
        async function analyzeNews() {
            const text = document.getElementById('newsText').value.trim();
            if (!text || text.length < 10) {
                alert('Please enter at least 10 characters of text');
                return;
            }
            
            // Show loading, hide empty state and previous results
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('analyzeBtn').disabled = true;
            
            try {
                // Send request to server
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text: text })
                });
                
                if (!response.ok) {
                    throw new Error('Server response was not ok');
                }
                
                const data = await response.json();
                
                // Hide loading
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('analyzeBtn').disabled = false;
                
                if (data.error) {
                    alert('Error: ' + data.error);
                    return;
                }
                
                // Update UI with results
                updateResultsUI(data);
                
                // Show results container
                document.getElementById('resultContainer').style.display = 'block';
                
            } catch (error) {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('analyzeBtn').disabled = false;
                alert('Error: ' + error.message);
            }
        }
        
        // Update UI with prediction results
        function updateResultsUI(data) {
            const resultCard = document.getElementById('resultCard');
            const resultBadge = document.getElementById('resultBadge');
            const confidenceBar = document.getElementById('confidenceBar');
            const confidenceText = document.getElementById('confidenceText');
            const trueProbability = document.getElementById('trueProbability');
            const fakeProbability = document.getElementById('fakeProbability');
            const resultTitle = document.getElementById('resultTitle');
            const resultSubtitle = document.getElementById('resultSubtitle');
            const indicatorsContainer = document.getElementById('indicatorsContainer');
            const indicatorsList = document.getElementById('indicatorsList');
            
            // Clear previous indicators
            indicatorsList.innerHTML = '';
            
            // Set colors and text based on result
            if (data.is_fake) {
                resultCard.className = 'mb-6 p-6 rounded-lg border-2 border-red-300 fake-gradient text-white transition-all duration-500';
                resultBadge.className = 'px-4 py-2 rounded-full text-lg font-bold bg-red-800 text-white';
                resultBadge.textContent = data.label || 'FAKE NEWS';
                resultTitle.textContent = 'Fake News Detected';
                resultSubtitle.textContent = '⚠ High probability of misinformation';
                confidenceBar.className = 'h-4 rounded-full transition-all duration-1000 bg-red-300';
                
                // Add glow effect for high confidence
                if (data.confidence > 0.8) {
                    resultCard.classList.add('glow');
                }
            } else {
                resultCard.className = 'mb-6 p-6 rounded-lg border-2 border-green-300 true-gradient text-white transition-all duration-500';
                resultBadge.className = 'px-4 py-2 rounded-full text-lg font-bold bg-green-800 text-white';
                resultBadge.textContent = data.label || 'RELIABLE NEWS';
                resultTitle.textContent = 'Reliable News';
                resultSubtitle.textContent = '✓ Appears to be authentic';
                confidenceBar.className = 'h-4 rounded-full transition-all duration-1000 bg-green-300';
                
                // Add glow effect for high confidence
                if (data.confidence > 0.8) {
                    resultCard.classList.add('glow');
                }
            }
            
            // Update confidence meter
            const confidence = Math.round(data.confidence * 100);
            confidenceBar.style.width = `${confidence}%`;
            confidenceText.textContent = `${confidence}% confidence`;
            
            // Update probabilities
            trueProbability.textContent = `${Math.round(data.true_probability * 100)}%`;
            fakeProbability.textContent = `${Math.round(data.fake_probability * 100)}%`;
            
            // Update analysis details
            let detailsText = `The AI analyzed ${data.text.length} characters. `;
            
            if (data.confidence > 0.8) {
                detailsText += `High confidence detection based on strong indicators. `;
            } else if (data.confidence > 0.6) {
                detailsText += `Moderate confidence with some indicators detected. `;
            } else {
                detailsText += `Low confidence - mixed indicators found. `;
            }
            
            if (data.sensational_score > 0) {
                detailsText += `Found ${data.sensational_score} sensationalism indicators. `;
            }
            if (data.reliable_score > 0) {
                detailsText += `Found ${data.reliable_score} reliability indicators. `;
            }
            
            document.getElementById('analysisDetails').textContent = detailsText;
            
            // Show key indicators if any
            if (data.key_indicators && data.key_indicators.length > 0) {
                indicatorsContainer.classList.remove('hidden');
                data.key_indicators.forEach(indicator => {
                    const indicatorElement = document.createElement('div');
                    indicatorElement.className = 'flex items-center text-sm p-2 bg-white/20 rounded';
                    indicatorElement.innerHTML = `
                        <i class="fas fa-circle text-xs mr-2 ${data.is_fake ? 'text-red-300' : 'text-green-300'}"></i>
                        <span>${indicator}</span>
                    `;
                    indicatorsList.appendChild(indicatorElement);
                });
            } else {
                indicatorsContainer.classList.add('hidden');
            }
        }
        
        // Reset form
        function resetForm() {
            document.getElementById('newsText').value = '';
            document.getElementById('charCount').textContent = '0 characters';
            document.getElementById('emptyState').style.display = 'block';
            document.getElementById('resultContainer').style.display = 'none';
        }
        
        // Check API health on page load
        window.onload = function() {
            fetch('/health')
                .then(response => response.json())
                .then(data => {
                    console.log('API Status:', data.status);
                    if (data.status === 'healthy') {
                        console.log('✓ AI system ready');
                    }
                })
                .catch(error => {
                    console.error('Health check failed:', error);
                });
        };
    </script>
</body>
</html>